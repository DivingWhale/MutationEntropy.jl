#-----------------------------------------------------------------------------
# Normalized Sigma_ij Matrix for HPS Urry Model
#-----------------------------------------------------------------------------
# Source: HPS Urry model sigma values
# res1 = ['A','R','N','D','C','Q','E','G','H','I','L','K','M','F','P','S','T','W','Y','V']
# sgm  = [5.04,6.56,5.68,5.58,5.48,6.02,5.92,4.50,6.08,6.18,6.18,6.36,6.18,6.36,5.56,5.18,5.62,6.78,6.46,5.86]
#
# Matrix construction: 
#   - Off-diagonal: sigma_ij[i,j] = (sigma_i + sigma_j) / 2, normalized by average of off-diagonal elements
#   - Diagonal: sigma_ij[i,i] = 1.0 (self-interaction is normalized to unity)
# Normalization ensures mean of off-diagonal elements = 1.0
#
# Residue order: A, R, N, D, C, Q, E, G, H, I, L, K, M, F, P, S, T, W, Y, V
#-----------------------------------------------------------------------------

const SIGMA_IJ_NORMALIZED = [
    1.0000 0.9866 0.9117 0.9032 0.8947 0.9406 0.9321 0.8114 0.9457 0.9542 0.9542 0.9696 0.9542 0.9696 0.9015 0.8692 0.9066 1.0053 0.9781 0.9270;
    0.9866 1.0000 1.0410 1.0325 1.0240 1.0699 1.0614 0.9406 1.0750 1.0835 1.0835 1.0988 1.0835 1.0988 1.0308 0.9985 1.0359 1.1345 1.1073 1.0563;
    0.9117 1.0410 1.0000 0.9576 0.9491 0.9951 0.9866 0.8658 1.0002 1.0087 1.0087 1.0240 1.0087 1.0240 0.9559 0.9236 0.9610 1.0597 1.0325 0.9815;
    0.9032 1.0325 0.9576 1.0000 0.9406 0.9866 0.9781 0.8573 0.9917 1.0002 1.0002 1.0155 1.0002 1.0155 0.9474 0.9151 0.9525 1.0512 1.0240 0.9730;
    0.8947 1.0240 0.9491 0.9406 1.0000 0.9781 0.9696 0.8488 0.9832 0.9917 0.9917 1.0070 0.9917 1.0070 0.9389 0.9066 0.9440 1.0427 1.0155 0.9644;
    0.9406 1.0699 0.9951 0.9866 0.9781 1.0000 1.0155 0.8947 1.0291 1.0376 1.0376 1.0529 1.0376 1.0529 0.9849 0.9525 0.9900 1.0886 1.0614 1.0104;
    0.9321 1.0614 0.9866 0.9781 0.9696 1.0155 1.0000 0.8862 1.0206 1.0291 1.0291 1.0444 1.0291 1.0444 0.9764 0.9440 0.9815 1.0801 1.0529 1.0019;
    0.8114 0.9406 0.8658 0.8573 0.8488 0.8947 0.8862 1.0000 0.8998 0.9083 0.9083 0.9236 0.9083 0.9236 0.8556 0.8233 0.8607 0.9593 0.9321 0.8811;
    0.9457 1.0750 1.0002 0.9917 0.9832 1.0291 1.0206 0.8998 1.0000 1.0427 1.0427 1.0580 1.0427 1.0580 0.9900 0.9576 0.9951 1.0937 1.0665 1.0155;
    0.9542 1.0835 1.0087 1.0002 0.9917 1.0376 1.0291 0.9083 1.0427 1.0000 1.0512 1.0665 1.0512 1.0665 0.9985 0.9662 1.0036 1.1022 1.0750 1.0240;
    0.9542 1.0835 1.0087 1.0002 0.9917 1.0376 1.0291 0.9083 1.0427 1.0512 1.0000 1.0665 1.0512 1.0665 0.9985 0.9662 1.0036 1.1022 1.0750 1.0240;
    0.9696 1.0988 1.0240 1.0155 1.0070 1.0529 1.0444 0.9236 1.0580 1.0665 1.0665 1.0000 1.0665 1.0818 1.0138 0.9815 1.0189 1.1175 1.0903 1.0393;
    0.9542 1.0835 1.0087 1.0002 0.9917 1.0376 1.0291 0.9083 1.0427 1.0512 1.0512 1.0665 1.0000 1.0665 0.9985 0.9662 1.0036 1.1022 1.0750 1.0240;
    0.9696 1.0988 1.0240 1.0155 1.0070 1.0529 1.0444 0.9236 1.0580 1.0665 1.0665 1.0818 1.0665 1.0000 1.0138 0.9815 1.0189 1.1175 1.0903 1.0393;
    0.9015 1.0308 0.9559 0.9474 0.9389 0.9849 0.9764 0.8556 0.9900 0.9985 0.9985 1.0138 0.9985 1.0138 1.0000 0.9134 0.9508 1.0495 1.0223 0.9713;
    0.8692 0.9985 0.9236 0.9151 0.9066 0.9525 0.9440 0.8233 0.9576 0.9662 0.9662 0.9815 0.9662 0.9815 0.9134 1.0000 0.9185 1.0172 0.9900 0.9389;
    0.9066 1.0359 0.9610 0.9525 0.9440 0.9900 0.9815 0.8607 0.9951 1.0036 1.0036 1.0189 1.0036 1.0189 0.9508 0.9185 1.0000 1.0546 1.0274 0.9764;
    1.0053 1.1345 1.0597 1.0512 1.0427 1.0886 1.0801 0.9593 1.0937 1.1022 1.1022 1.1175 1.1022 1.1175 1.0495 1.0172 1.0546 1.0000 1.1260 1.0750;
    0.9781 1.1073 1.0325 1.0240 1.0155 1.0614 1.0529 0.9321 1.0665 1.0750 1.0750 1.0903 1.0750 1.0903 1.0223 0.9900 1.0274 1.1260 1.0000 1.0478;
    0.9270 1.0563 0.9815 0.9730 0.9644 1.0104 1.0019 0.8811 1.0155 1.0240 1.0240 1.0393 1.0240 1.0393 0.9713 0.9389 0.9764 1.0750 1.0478 1.0000
]

# Mapping from residue character to matrix index
const RESIDUE_TO_INDEX = Dict{Char, Int}(
    'A' => 1,  'R' => 2,  'N' => 3,  'D' => 4,  'C' => 5,
    'Q' => 6,  'E' => 7,  'G' => 8,  'H' => 9,  'I' => 10,
    'L' => 11, 'K' => 12, 'M' => 13, 'F' => 14, 'P' => 15,
    'S' => 16, 'T' => 17, 'W' => 18, 'Y' => 19, 'V' => 20
)