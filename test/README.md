# 测试文件说明

这个测试文件 `test_entropy.jl` 为 `entropy.jl` 中的所有主要函数提供了全面的测试覆盖。

## 测试覆盖的函数

### 1. 基础函数测试
- **`Φ` 函数**: 测试指数衰减函数的正确性
- **`Γ` 函数**: 测试协方差矩阵的构建，包括对称性和行和为零的性质
- **`compute_Γ` 函数**: 测试组合两个Γ矩阵的功能
- **`msf` 函数**: 测试均方波动的计算

### 2. 文件I/O函数测试
- **`read_xvg` 函数**: 创建临时文件测试XVG格式的读取
- **`read_mutations_from_file` 函数**: 测试从文件读取突变列表

### 3. 数据处理函数测试
- **`ΔΔS` 函数**: 测试熵变计算，包括偏移量处理
- **`ΔΔG_prime` 函数**: 测试修正自由能的计算
- **`parse_mutation_position` 函数**: 测试从突变字符串中提取位置信息
- **`get_experimental_ddg` 函数**: 测试从DataFrame中获取实验值

### 4. 集成测试
- 测试完整的工作流程：从坐标到MSF计算
- 测试PAE处理工作流程
- 验证函数间的正确交互

## 测试特点

1. **使用临时文件**: 对于文件I/O操作，使用临时文件确保测试的独立性
2. **数值精度检查**: 使用适当的容差检查浮点数计算
3. **边界条件测试**: 测试特殊情况如奇异矩阵
4. **类型检查**: 验证返回值的类型正确性
5. **清理机制**: 在finally块中清理临时文件

## 运行测试

在项目根目录下运行：

```bash
julia --project=. -e "using Pkg; Pkg.test()"
```

或者在Julia REPL中：

```julia
using Pkg
Pkg.test("MutationEntropy")
```

所有47个测试都应该通过，确保代码的正确性和稳定性。
